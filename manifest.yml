id: org.flatpak.positron
runtime: org.freedesktop.Platform
runtime-version: "23.08"
sdk: org.freedesktop.Sdk
command: org.flatpak.positron.sh
finish-args:
    - --socket=x11
    - --socket=wayland
    - --device=dri
    - --filesystem=~/.var/app/org.flatpak.positron/data
modules:
    - name: python
      buildsystem: simple
      build-commands:
          - mkdir -p /app/wheels
          - cp wheels/*.whl /app/wheels/
          - cp app.py /app/
          - cp -r static /app/
          - cp -r templates /app/
          - pip3 install --prefix=/app wheels/*.whl
      sources:
          - type: dir
            path: .

    - name: firefox
      buildsystem: simple
      build-commands:
          # Copy the tarball to the build directory
          - cp firefox.tar.bz2 /app/
          - tar -xf /app/firefox.tar.bz2 -C /app/
          - rm /app/firefox.tar.bz2
          # Copy the firefox profile
          - cp profile.tar.gz /app/
          - tar -xf /app/profile.tar.gz -C /app/
          - rm /app/profile.tar.gz
      sources:
          - type: dir
            path: .

    - name: positron
      buildsystem: simple
      build-commands:
          - install -Dm755 ${FLATPAK_ID}.sh -t /app/bin
      sources:
          - type: file
            path: org.flatpak.positron.sh
